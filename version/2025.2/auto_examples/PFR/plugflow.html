
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Simulate NO reduction in combustion exhaust &#8212; PyChemkin</title>

  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/ansys_sphinx_theme.css?v=d2ac875c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://www.nerdfonts.com/assets/css/webfont.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>
 
<link href="../../_static/css/breadcrumbs.css" rel="stylesheet" />

    <script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/table.js?v=b64f5182"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/PFR/plugflow';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://chemkin.docs.pyansys.com/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PSR network" href="../reactor_network/index.html" />
    <link rel="prev" title="Plug-flow reactor" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <link rel="canonical" href="https://chemkin.docs.pyansys.com/version/stable/auto_examples/PFR/plugflow.html" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container"><!-- Debugging: html_theme_options =  -->

  <!-- If there is no MeiliSearch enabled, use the PyData search -->
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

   
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="https://docs.pyansys.com/">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/pyansys_logo_transparent_black.png" class="logo__image only-light" alt="PyChemkin - Home"/>
    <script>document.write(`<img src="../../_static/pyansys_logo_transparent_white.png" class="logo__image only-dark" alt="PyChemkin - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pychemkin" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pychemkin/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://chemkin.docs.pyansys.com/version/dev/_static/assets/download/pychemkin.pdf" title="Download documentation in PDF" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-file-pdf fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Download documentation in PDF</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
    <div id="announcement_msg"></div>
<script>
  fetch("announcement.html")
    .then((response) => {
      if (!response.ok) {
        throw new Error(`HTTP error: ${response.status}`);
      }
      return response.text();
    })
    .then(
      (text) => (document.getElementById("announcement_msg").innerHTML = text),
    )
    .catch((error) => console.error(`Fetch problem: ${error.message}`));
</script>  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pychemkin" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pychemkin/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://chemkin.docs.pyansys.com/version/dev/_static/assets/download/pychemkin.pdf" title="Download documentation in PDF" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-file-pdf fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Download documentation in PDF</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chemistry/index.html">Chemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixture/index.html">Mixture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch/index.html">Batch reactor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../engine/index.html">0-D engine models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PSR/index.html">Perfectly stirred reactor</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Plug-flow reactor</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Simulate NO reduction in combustion exhaust</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../reactor_network/index.html">PSR network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../premixed_flame/index.html">Premixed flame models</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">
<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
         
    <li class="breadcrumb-item breadcrumb-home">
      <a href="https://docs.pyansys.com/" class="nav-link">PyAnsys</a>
    </li>
     
    <li class="breadcrumb-item">
      <a
        href="../../index.html"
        class="nav-link"
        aria-label="Home"
      >
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="../index.html" class="nav-link">Examples</a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="index.html" class="nav-link">Plug-flow reactor</a>
    </li>
      
    <li class="breadcrumb-item active" aria-current="page">Simulate NO reduction in combustion exhaust</li>
    
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-pfr-plugflow-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="simulate-no-reduction-in-combustion-exhaust">
<span id="ref-plug-flow-reactor"></span><span id="sphx-glr-auto-examples-pfr-plugflow-py"></span><h1>Simulate NO reduction in combustion exhaust<a class="headerlink" href="#simulate-no-reduction-in-combustion-exhaust" title="Link to this heading">#</a></h1>
<p>The PFR (plug flow reactor) model is widely adopted in the chemical kinetic
studies of emission abatement processes because of its simplicity in flow treatment
as well as its resemblance of an exhaust duct or a tailpipe.</p>
<p>The PFR model is a steady-state open reactor because materials are allowed to
move in and out of the reactor. The solutions are obtained along the length of the reactor
as the inlet materials march toward the reactor exit. Typically, the pressure of the PFR
is fixed. However, Chemkin does permit the use of a pressure profile to enforce a certain
pressure gradient in the PFR.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">PlugFlowReactor_FixedTemperature()</span></code> or <code class="docutils literal notranslate"><span class="pre">PlugFlowReactor_EnergyConservation()</span></code>
method to create a PFR. Unlike the closed batch reactor model, which is instantiated by a mixture,
the open reactor model, such as the PFR model, is initiated by a stream, which is
simply a mixture with the addition of the inlet mass/volumetric
flow rate or velocity. You already know how to create a stream if you know how to create
a mixture. You can specify the inlet flow rate using one of these methods:
<code class="docutils literal notranslate"><span class="pre">velocity()</span></code>, <code class="docutils literal notranslate"><span class="pre">mass_flowrate()</span></code>, <code class="docutils literal notranslate"><span class="pre">vol_flowrate()</span></code>, or <code class="docutils literal notranslate"><span class="pre">sccm()</span></code>
(standard cubic centimeters per minute).</p>
<p>This example shows how to use the Chemkin PFR model to study the
reduction of nitric oxide (NO) in the combustion exhaust by using the
CH<sub>4</sub> reburning process. This is achieved by injecting CH<sub>4</sub> into the
hot exhaust gas mixture. As the exhaust gas travels along the tubular reactor, the injected
CH<sub>4</sub> is oxidized by the NO to form N<sub>2</sub>, CO, and H<sub>2</sub>. This is why this NO reduction process is called <em>methane reburning</em>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<section id="import-pychemkin-packages-and-start-the-logger">
<h2>Import PyChemkin packages and start the logger<a class="headerlink" href="#import-pychemkin-packages-and-start-the-logger" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ansys.chemkin</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ck</span>  <span class="c1"># Chemkin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.chemkin</span><span class="w"> </span><span class="kn">import</span> <span class="n">Color</span>

<span class="c1"># chemkin plug flow reactor model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.chemkin.flowreactors.PFR</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlugFlowReactor_FixedTemperature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.chemkin.inlet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Stream</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.chemkin.logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>  <span class="c1"># plotting</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>  <span class="c1"># number crunching</span>

<span class="c1"># check working directory</span>
<span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;working directory: &quot;</span> <span class="o">+</span> <span class="n">current_dir</span><span class="p">)</span>
<span class="c1"># set interactive mode for plotting the results</span>
<span class="c1"># interactive = True: display plot</span>
<span class="c1"># interactive = False: save plot as a PNG file</span>
<span class="k">global</span> <span class="n">interactive</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="create-a-chemistry-set">
<h2>Create a chemistry set<a class="headerlink" href="#create-a-chemistry-set" title="Link to this heading">#</a></h2>
<p>The mechanism to load is the C2 NOx mechanism for the combustion of C1-C2 hydrocarbons.
The mechanism comes with the standard Ansys Chemkin
installation in the <code class="docutils literal notranslate"><span class="pre">/reaction/data</span></code> directory.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># set mechanism directory (the default Chemkin mechanism data directory)</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ck</span><span class="o">.</span><span class="n">ansys_dir</span><span class="p">,</span> <span class="s2">&quot;reaction&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">mechanism_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="c1"># create a chemistry set based on the GRI mechanism</span>
<span class="n">MyGasMech</span> <span class="o">=</span> <span class="n">ck</span><span class="o">.</span><span class="n">Chemistry</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;C2 NOx&quot;</span><span class="p">)</span>
<span class="c1"># set mechanism input files</span>
<span class="c1"># including the full file path is recommended</span>
<span class="n">MyGasMech</span><span class="o">.</span><span class="n">chemfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mechanism_dir</span><span class="p">,</span> <span class="s2">&quot;C2_NOx_SRK.inp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="preprocess-the-gri-3-0-chemistry-set">
<h2>Preprocess the GRI 3.0 chemistry set<a class="headerlink" href="#preprocess-the-gri-3-0-chemistry-set" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># preprocess the mechanism files</span>
<span class="n">iError</span> <span class="o">=</span> <span class="n">MyGasMech</span><span class="o">.</span><span class="n">preprocess</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="instantiate-and-set-up-the-stream">
<h2>Instantiate and set up the stream<a class="headerlink" href="#instantiate-and-set-up-the-stream" title="Link to this heading">#</a></h2>
<p>Create a hot exhaust gas mixture by assigning the mole fractions of the
species. A stream is simply a mixture with the addition of
mass/volumetric flow rate or velocity. Here, the gas composition <code class="docutils literal notranslate"><span class="pre">exhaust.X</span></code> is given
by a recipe consisting of the common species in the combustion exhaust, such as
CO<sub>2</sub> and H<sub>2`O and the CH:sub:`4</sub> injected. The inlet velocity
is given by <code class="docutils literal notranslate"><span class="pre">exhaust.velocity</span> <span class="pre">=</span> <span class="pre">26.815</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the inlet (mixture + flow rate)</span>
<span class="n">exhaust</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">MyGasMech</span><span class="p">)</span>
<span class="c1"># set inlet temperature [K]</span>
<span class="n">exhaust</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">1750.0</span>
<span class="c1"># set inlet/PFR pressure [atm]</span>
<span class="n">exhaust</span><span class="o">.</span><span class="n">pressure</span> <span class="o">=</span> <span class="mf">0.83</span> <span class="o">*</span> <span class="n">ck</span><span class="o">.</span><span class="n">Patm</span>
<span class="c1"># set inlet molar composition directly</span>
<span class="n">exhaust</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;CO&quot;</span><span class="p">,</span> <span class="mf">0.0145</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;CO2&quot;</span><span class="p">,</span> <span class="mf">0.0735</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">,</span> <span class="mf">0.1107</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;NO&quot;</span><span class="p">,</span> <span class="mf">0.0012</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;N2&quot;</span><span class="p">,</span> <span class="mf">0.7981</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;CH4&quot;</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">),</span>
<span class="p">]</span>
<span class="c1"># set inlet velocity [cm/sec]</span>
<span class="n">exhaust</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="mf">26.815</span>
<span class="c1">#</span>
</pre></div>
</div>
</section>
<section id="create-the-plug-flow-reactor-object">
<h2>Create the plug flow reactor object<a class="headerlink" href="#create-the-plug-flow-reactor-object" title="Link to this heading">#</a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">PlugFlowReactor_FixedTemperature()</span></code> method to create a plug flow reactor.
The required input parameter of the open reactor models in PyChemkin
is the stream, while PyChemkin batch reactor models take a mixture
as the input parameter. In this case, the exhaust stream is used to create a
PFR named <code class="docutils literal notranslate"><span class="pre">tubereactor</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tubereactor</span> <span class="o">=</span> <span class="n">PlugFlowReactor_FixedTemperature</span><span class="p">(</span><span class="n">exhaust</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="set-up-additional-reactor-model-parameters">
<h2>Set up additional reactor model parameters<a class="headerlink" href="#set-up-additional-reactor-model-parameters" title="Link to this heading">#</a></h2>
<p>For the PFR, the required reactor parameters are the reactor diameter [cm] or the
cross-sectional flow area [cm2] and the reactor length [cm].
The mixture condition and inlet mass flow rate of the inlet are already defined
by the stream when the <code class="docutils literal notranslate"><span class="pre">tubereactor</span></code> PFR is instantiated.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># set PFR diameter [cm]</span>
<span class="n">tubereactor</span><span class="o">.</span><span class="n">diameter</span> <span class="o">=</span> <span class="mf">5.8431</span>
<span class="c1"># set PFR length [cm]</span>
<span class="n">tubereactor</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">5.0</span>
</pre></div>
</div>
</section>
<section id="verify-the-inlet-condition-of-the-pfr">
<h2>Verify the inlet condition of the PFR<a class="headerlink" href="#verify-the-inlet-condition-of-the-pfr" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PFR inlet mass flow rate </span><span class="si">{</span><span class="n">tubereactor</span><span class="o">.</span><span class="n">mass_flowrate</span><span class="si">}</span><span class="s2"> [g/sec]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PFR inlet velocity </span><span class="si">{</span><span class="n">tubereactor</span><span class="o">.</span><span class="n">velocity</span><span class="si">}</span><span class="s2"> [cm/sec]&quot;</span><span class="p">)</span>
<span class="c1"># show inlet gas composition of the PFR</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PFR inlet gas compsition&quot;</span><span class="p">)</span>
<span class="n">tubereactor</span><span class="o">.</span><span class="n">list_composition</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="set-output-options">
<h2>Set output options<a class="headerlink" href="#set-output-options" title="Link to this heading">#</a></h2>
<p>You can turn on adaptive solution saving to resolve the steep variations in the solution
profile. Here, additional solution data points are saved for every <strong>100</strong> internal solver steps.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, distance intervals for both print and save solution are 1/100 of the
reactor length. In this case, <span class="math notranslate nohighlight">\(dt=time/100=0.001\)</span>. You can change them
to different values.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># set distance between saving solution</span>
<span class="n">tubereactor</span><span class="o">.</span><span class="n">timestep_for_saving_solution</span> <span class="o">=</span> <span class="mf">0.0005</span>
<span class="c1"># turn on adaptive solution saving</span>
<span class="n">tubereactor</span><span class="o">.</span><span class="n">adaptive_solution_saving</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="display-the-added-parameters-keywords">
<h2>Display the added parameters (keywords)<a class="headerlink" href="#display-the-added-parameters-keywords" title="Link to this heading">#</a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">showkeywordinputlines()</span></code> method to verify that the preceding
parameters are correctly assigned to the reactor model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tubereactor</span><span class="o">.</span><span class="n">showkeywordinputlines</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="run-the-parameter-study-to-replicate-the-experiments">
<h2>Run the parameter study to replicate the experiments<a class="headerlink" href="#run-the-parameter-study-to-replicate-the-experiments" title="Link to this heading">#</a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">run()</span></code> method to start the plug flow simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use two <code class="docutils literal notranslate"><span class="pre">time</span></code> calls (one before the run and one after the run) to
get the simulation run time (wall time).</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the start wall time</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># run the PFR model</span>
<span class="n">runstatus</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># compute the total runtime</span>
<span class="n">runtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="c1"># check run status</span>
<span class="k">if</span> <span class="n">runstatus</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="c1"># Run failed.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span> <span class="o">+</span> <span class="s2">&quot;&gt;&gt;&gt; Run failed. &lt;&lt;&lt;&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">Color</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
    <span class="n">exit</span><span class="p">()</span>
<span class="c1"># run succeeded.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">GREEN</span> <span class="o">+</span> <span class="s2">&quot;&gt;&gt;&gt; Run completed. &lt;&lt;&lt;&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">Color</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total simulation duration: </span><span class="si">{</span><span class="n">runtime</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0e3</span><span class="si">}</span><span class="s2"> [msec]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="postprocess-the-solution">
<h2>Postprocess the solution<a class="headerlink" href="#postprocess-the-solution" title="Link to this heading">#</a></h2>
<p>The postprocessing step parses the solution and packages the solution values at each
time point into a mixture. There are two ways to access the solution profiles:</p>
<ul class="simple">
<li><p>The raw solution profiles (value as a function of distance) are available for distance,
temperature, pressure, volume, and species mass fractions.</p></li>
<li><p>The mixtures permit the use of all property and rate utilities to extract
information such as viscosity, density, and mole fractions.</p></li>
</ul>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">get_solution_variable_profile()</span></code> method to get the raw solution profiles. You
can get solution mixtures using either the <code class="docutils literal notranslate"><span class="pre">get_solution_mixture_at_index()</span></code> method for the
solution mixture at the given saved location or the <code class="docutils literal notranslate"><span class="pre">get_solution_mixture()</span></code> method for the
solution mixture at the given distance. (In this case, the mixture is constructed by interpolation.)</p>
<p>You can get the outlet solution by simply grabbing the solution values at the very last point by
using <span class="math notranslate nohighlight">\((outlet solution index) = (number of solutions) - 1\)</span>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># postprocess the solution profiles</span>
<span class="n">tubereactor</span><span class="o">.</span><span class="n">process_solution</span><span class="p">()</span>

<span class="c1"># get the number of solution time points</span>
<span class="n">solutionpoints</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">getnumbersolutionpoints</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of solution points = </span><span class="si">{</span><span class="n">solutionpoints</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># get the grid profile [cm]</span>
<span class="n">xprofile</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_variable_profile</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="c1"># get the temperature profile [K]</span>
<span class="n">tempprofile</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_variable_profile</span><span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">)</span>
<span class="c1"># get the CH4 mass fraction profile</span>
<span class="n">YCH4profile</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_variable_profile</span><span class="p">(</span><span class="s2">&quot;CH4&quot;</span><span class="p">)</span>
<span class="c1"># get the CO mass fraction profile</span>
<span class="n">YCOprofile</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_variable_profile</span><span class="p">(</span><span class="s2">&quot;CO&quot;</span><span class="p">)</span>
<span class="c1"># get the H2O mass fraction profile</span>
<span class="n">YH2Oprofile</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_variable_profile</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span>
<span class="c1"># get the H2 mass fraction profile</span>
<span class="n">YH2profile</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_variable_profile</span><span class="p">(</span><span class="s2">&quot;H2&quot;</span><span class="p">)</span>
<span class="c1"># get the NO mass fraction profile</span>
<span class="n">YNOprofile</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_variable_profile</span><span class="p">(</span><span class="s2">&quot;NO&quot;</span><span class="p">)</span>
<span class="c1"># get the N2 mass fraction profile</span>
<span class="n">YN2profile</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_variable_profile</span><span class="p">(</span><span class="s2">&quot;N2&quot;</span><span class="p">)</span>

<span class="c1"># inlet NO mass fraction</span>
<span class="n">YNO_inlet</span> <span class="o">=</span> <span class="n">exhaust</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">MyGasMech</span><span class="o">.</span><span class="n">get_specindex</span><span class="p">(</span><span class="s2">&quot;NO&quot;</span><span class="p">)]</span>
<span class="c1"># outlet grid index</span>
<span class="n">xout_index</span> <span class="o">=</span> <span class="n">solutionpoints</span> <span class="o">-</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At the reactor inlet: x = 0 [xm]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The NO mass fraction = </span><span class="si">{</span><span class="n">YNO_inlet</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;At the reactor outlet: x = </span><span class="si">{</span><span class="n">xprofile</span><span class="p">[</span><span class="n">xout_index</span><span class="p">]</span><span class="si">}</span><span class="s2"> [cm]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The NO mass fraction = </span><span class="si">{</span><span class="n">YNOprofile</span><span class="p">[</span><span class="n">xout_index</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The NO conversion rate = &quot;</span>
    <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">YNO_inlet</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">YNOprofile</span><span class="p">[</span><span class="n">xout_index</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">YNO_inlet</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100.0</span><span class="si">}</span><span class="s2"> %</span><span class="se">\n</span><span class="s2">.&quot;</span>
<span class="p">)</span>

<span class="c1"># more involved postprocessing using mixtures</span>
<span class="c1">#</span>
<span class="c1"># create arrays for the gas velocity profile</span>
<span class="n">velocityprofile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xprofile</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
<span class="c1"># reactor mass flow rate (constant) [g/sec]</span>
<span class="n">massflowrate</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">mass_flowrate</span>
<span class="c1"># reactor cross-section area [cm2]</span>
<span class="n">areaflow</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">flowarea</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mass flow rate: </span><span class="si">{</span><span class="n">massflowrate</span><span class="si">}</span><span class="s2"> [g/sec]</span><span class="se">\n</span><span class="s2">flow area: </span><span class="si">{</span><span class="n">areaflow</span><span class="si">}</span><span class="s2"> [cm2]&quot;</span><span class="p">)</span>
<span class="c1"># ratio</span>
<span class="n">ratio</span> <span class="o">=</span> <span class="n">massflowrate</span> <span class="o">/</span> <span class="n">areaflow</span>
<span class="c1"># loop over all solution time points</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solutionpoints</span><span class="p">):</span>
    <span class="c1"># get the mixture at the time point</span>
    <span class="n">solutionmixture</span> <span class="o">=</span> <span class="n">tubereactor</span><span class="o">.</span><span class="n">get_solution_mixture_at_index</span><span class="p">(</span><span class="n">solution_index</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># get gas density [g/cm3]</span>
    <span class="n">den</span> <span class="o">=</span> <span class="n">solutionmixture</span><span class="o">.</span><span class="n">RHO</span>
    <span class="c1"># gas velocity [g]</span>
    <span class="n">velocityprofile</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">/</span> <span class="n">den</span>
</pre></div>
</div>
</section>
<section id="plot-the-solution-profiles">
<h2>Plot the solution profiles<a class="headerlink" href="#plot-the-solution-profiles" title="Link to this heading">#</a></h2>
<p>Plot the species and the gas velocity profiles along the tubular reactor.</p>
<p>You can see from the plots that CH<sub>4</sub> is mainly oxidized by NO to form
N<sub>2</sub> and H<sub>2</sub>in the hot exhaust. The gas velocity accelerates because of
the net increase in total number of moles of gas species due to the chemical reactions.
You can conduct more in depth analyses of the reaction pathways of the CH<sub>4</sub> reburning
mechanism by applying other PyChemkin utilities.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Constant Temperature Plug-Flow Reactor&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xprofile</span><span class="p">,</span> <span class="n">YN2profile</span><span class="p">,</span> <span class="s2">&quot;r-&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;N2 Mass Fraction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xprofile</span><span class="p">,</span> <span class="n">YH2Oprofile</span><span class="p">,</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;H2O Mass Fraction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xprofile</span><span class="p">,</span> <span class="n">YNOprofile</span><span class="p">,</span> <span class="s2">&quot;g-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NO&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xprofile</span><span class="p">,</span> <span class="n">YCH4profile</span><span class="p">,</span> <span class="s2">&quot;g:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CH4&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xprofile</span><span class="p">,</span> <span class="n">YH2profile</span><span class="p">,</span> <span class="s2">&quot;g--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;H2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;distance [cm]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mass Fraction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xprofile</span><span class="p">,</span> <span class="n">velocityprofile</span><span class="p">,</span> <span class="s2">&quot;m-&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;distance [cm]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Gas Velocity [cm/sec]&quot;</span><span class="p">)</span>
<span class="c1"># plot results</span>
<span class="k">if</span> <span class="n">interactive</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plot_plug_flow_reactor.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-pfr-plugflow-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/2f95160b040a45f41d940eb503846268/plugflow.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plugflow.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/94cb59d6154f4074fd16faac07b36524/plugflow.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plugflow.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4c67bc35f4768a1259f4f98f8eea7bfa/plugflow.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plugflow.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-pychemkin-packages-and-start-the-logger">Import PyChemkin packages and start the logger</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-chemistry-set">Create a chemistry set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocess-the-gri-3-0-chemistry-set">Preprocess the GRI 3.0 chemistry set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instantiate-and-set-up-the-stream">Instantiate and set up the stream</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-plug-flow-reactor-object">Create the plug flow reactor object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-additional-reactor-model-parameters">Set up additional reactor model parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-the-inlet-condition-of-the-pfr">Verify the inlet condition of the PFR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-output-options">Set output options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-added-parameters-keywords">Display the added parameters (keywords)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-parameter-study-to-replicate-the-experiments">Run the parameter study to replicate the experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#postprocess-the-solution">Postprocess the solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-solution-profiles">Plot the solution profiles</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item"> 
<div class="tocsection editthispage">
  <a href="https://github.com/ansys/pychemkin/edit/main/doc/source/auto_examples/PFR/plugflow.rst">
    <i class="fa-solid fa-pencil"></i>
       Edit
    on GitHub  
  </a>
</div>

</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/auto_examples/PFR/plugflow.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright (c) 2025 ANSYS, Inc. All rights reserved.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the
  <a href="https://sphinxdocs.ansys.com/version/stable/index.html"
    >Ansys Sphinx Theme</a
  >
  1.0.11. <br />Last updated on
  <span id="date"></span>
</p>
<script>
  var options = { day: "numeric", month: "long", year: "numeric" };
  var lastModifiedDate = new Date(document.lastModified);
  var date = lastModifiedDate.toLocaleDateString("en-US", options);
  document.getElementById("date").innerHTML = date;
</script></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>